bigrams = [["th", 1.52],["he", 1.28],["in", 0.94],["er", 0.94],["an", 0.82],["re", 0.68],["nd", 0.63],["at", 0.59],["on", 0.57],["nt", 0.56],["ha", 0.56],["es", 0.56],["st", 0.55],["en", 0.55],["ed", 0.53],["to", 0.52],["it", 0.50],["ou", 0.50],["ea", 0.47],["hi", 0.46],["is", 0.46],["or", 0.43],["ti", 0.34],["as", 0.33],["te", 0.27],["et", 0.19],["ng", 0.18],["of", 0.16],["al", 0.09],["de", 0.09],["se", 0.08],["le", 0.08],["sa", 0.06],["si", 0.05],["ar", 0.04],["ve", 0.04],["ra", 0.04],["ld", 0.02],["ur", 0.02]]
trigrams = [["THE", 1.87], ["AND", 0.78], ["ING", 0.69], ["HER", 0.42], ["THA", 0.37], ["ENT", 0.36], ["ERE", 0.33], ["ION", 0.33], ["ETH", 0.32], ["NTH", 0.32], ["HAT", 0.31], ["INT", 0.29], ["FOR", 0.28], ["ALL", 0.27], ["STH", 0.26], ["TER", 0.26], ["EST", 0.26], ["TIO", 0.26], ["HIS", 0.25], ["OFT", 0.24], ["HES", 0.24], ["ITH", 0.24], ["ERS", 0.24], ["ATI", 0.24], ["OTH", 0.23], ["FTH", 0.23], ["DTH", 0.23], ["VER", 0.22], ["TTH", 0.22], ["THI", 0.22], ["REA", 0.21], ["SAN", 0.21], ["WIT", 0.21], ["ATE", 0.2], ["ARE", 0.2], ["EAR", 0.19], ["RES", 0.19], ["ONT", 0.18], ["TIN", 0.18], ["ESS", 0.18], ["RTH", 0.18], ["WAS", 0.18], ["SOF", 0.18], ["EAN", 0.17], ["YOU", 0.17], ["SIN", 0.17], ["STO", 0.17], ["IST", 0.17], ["EDT", 0.16], ["EOF", 0.16], ["EVE", 0.16], ["ONE", 0.16], ["AST", 0.16], ["ONS", 0.16], ["DIN", 0.16], ["OME", 0.16], ["CON", 0.16], ["ERA", 0.16], ["STA", 0.15], ["OUR", 0.15], ["NCE", 0.15], ["TED", 0.15], ["GHT", 0.15], ["HEM", 0.15], ["MAN", 0.15], ["HEN", 0.15], ["NOT", 0.15], ["ORE", 0.15], ["OUT", 0.15], ["ORT", 0.15], ["ESA", 0.15], ["ERT", 0.15], ["SHE", 0.14], ["ANT", 0.14], ["NGT", 0.14], ["EDI", 0.14], ["ERI", 0.14], ["EIN", 0.14], ["NDT", 0.14], ["NTO", 0.14], ["ATT", 0.14], ["ECO", 0.13], ["AVE", 0.13], ["MEN", 0.13], ["HIN", 0.13], ["HEA", 0.13], ["IVE", 0.13], ["EDA", 0.13], ["INE", 0.13], ["RAN", 0.13], ["HEC", 0.13], ["TAN", 0.13], ["RIN", 0.13], ["ILL", 0.13], ["NDE", 0.13], ["THO", 0.13], ["HAN", 0.13], ["COM", 0.12], ["IGH", 0.12], ["AIN", 0.12]]

def removespace(text):
    textnospace = []
    for c in text:
        if c.isalpha():
            textnospace.append(c.lower())
    return textnospace

def countngram(text, n, list):
    bigram_count = [0] * len(list)
    for i in range(len(text)-n):
        chars = ''
        for k in range(n):
            chars += text[i + k]
        for j in range(len(list)):
            if chars == list[j][0].lower():
                bigram_count[j] += 1
    #percentage
    for i in range(len(list)):
        bigram_count[i] = bigram_count[i] / (len(text)-1) * 100

    return bigram_count

def checkenglishnes(percentage, data):
    score = 0.00000000000
    if len(data) != len(percentage):
        return score
    for i in range(len(data)):
        if percentage[i] > data[i][1]:
            score += 1
        else:
            score += (percentage[i]/data[i][1])**2
    return score

def get_english_score(text):
    biscore = checkenglishnes(countngram(removespace(text), 2, bigrams), bigrams)
    triscore = checkenglishnes(countngram(removespace(text), 3, trigrams), trigrams)
    score = biscore * 0.4 + triscore * 0.6
    return score

if __name__ == '__main__':
    text = "life had been relatively dull since returning from my work with harry in the middle east. the british library was delighted to get its hands on the roman diary and the collector seemed to have forgotten about me maybe because harrys team made it too dangerous to hang around. i was happy to settle back in to my work at the library and was involved in a project to track down and catalogue missing documents from the late nineteenth century. they detailed foreign policy which sounds dull but with victoria taking an active interest there were a lot of letters between downing street and the palace and i was enjoying spying on famous characters from history. i really felt like i was getting some insight into how they thought and how the modern world came into being in that tumultuous period. while i was mainly there to check the letters for authenticity i got really involved in trying to understand how they all fitted together and part of the job was to cross check statements in the letters with what we know actually happened. there are a lot of people who will pay a lot of money to own a letter from a royal so the archive is plagued with forgeries. some of them you can detect by analysing the paper others by the writing style. some just fall over because the content is out of line with other documents but as i studied them i began to realise that a number of them hinted at events that i couldnt find in the historical record. certain names appeared and were clearly important and then disappeared completely from trace. diplomatic incidents were mentioned that never happened according to the history books. one thing you learn in this business is that the civil service never lets any decision however secret go unrecorded. of course that might just have meant those letters and documents were fake but i pride myself on being an excellent forger and i would not have been able to produce them. the paper was right the ink was chemically correct and aged just the right amount and the style of writing was totally convincing. and i was convinced. convinced that somewhere there must be an archive of government documents from the period that recorded all of these missing stories in full. then i received the message about the shadow archive someone else knew about it and had worked out that i was hunting for it too the postcard didnt help much but the emails did the first one had the subject line jekyll and hyde and was encrypted using a simple caesar shift to discourage casual interest it didnt take me long to crack it and the names and details it contained matched the growing list of mysterious references from my own research douglas black was clearly an important figure and i had a feeling that he had something to do with the archive that feeling was confirmed by the second email black heart that i received later that week again it was encrypted but this time using an affine shift cipher it was clearly from the same individual  at the very least whoever was sending me the emails had a habit of missing the letter r from the word your someone was playing games with me and i was more than happy to join in"
    #text = "SPML OHK ILLU YLSHAPCLSF KBSS ZPUJL YLABYUPUN MYVT TF DVYR DPAO OHYYF PU AOL TPKKSL LHZA. AOL IYPAPZO SPIYHYF DHZ KLSPNOALK AV NLA PAZ OHUKZ VU AOL YVTHU KPHYF HUK AOL JVSSLJAVY ZLLTLK AV OHCL MVYNVAALU HIVBA TL, THFIL ILJHBZL OHYYF’Z ALHT THKL PA AVV KHUNLYVBZ AV OHUN HYVBUK. P DHZ OHWWF AV ZLAASL IHJR PU AV TF DVYR HA AOL SPIYHYF HUK DHZ PUCVSCLK PU H WYVQLJA AV AYHJR KVDU HUK JHAHSVNBL TPZZPUN KVJBTLUAZ MYVT AOL SHAL UPULALLUAO JLUABYF. AOLF KLAHPSLK MVYLPNU WVSPJF, DOPJO ZVBUKZ KBSS, IBA DPAO CPJAVYPH AHRPUN HU HJAPCL PUALYLZA AOLYL DLYL H SVA VM SLAALYZ ILADLLU KVDUPUN ZAYLLA HUK AOL WHSHJL HUK P DHZ LUQVFPUN ZWFPUN VU MHTVBZ JOHYHJALYZ MYVT OPZAVYF. P YLHSSF MLSA SPRL P DHZ NLAAPUN ZVTL PUZPNOA PUAV OVD AOLF AOVBNOA HUK OVD AOL TVKLYU DVYSK JHTL PUAV ILPUN PU AOHA ABTBSABVBZ WLYPVK.DOPSL P DHZ THPUSF AOLYL AV JOLJR AOL SLAALYZ MVY HBAOLUAPJPAF, P NVA YLHSSF PUCVSCLK PU AYFPUN AV BUKLYZAHUK OVD AOLF HSS MPAALK AVNLAOLY, HUK WHYA VM AOL QVI DHZ AV JYVZZ JOLJR ZAHALTLUAZ PU AOL SLAALYZ DPAO DOHA DL RUVD HJABHSSF OHWWLULK. AOLYL HYL H SVA VM WLVWSL DOV DPSS WHF H SVA VM TVULF AV VDU H SLAALY MYVT H YVFHS, ZV AOL HYJOPCL PZ WSHNBLK DPAO MVYNLYPLZ. ZVTL VM AOLT FVB JHU KLALJA IF HUHSFZPUN AOL WHWLY, VAOLYZ IF AOL DYPAPUN ZAFSL. ZVTL QBZA MHSS VCLY ILJHBZL AOL JVUALUA PZ VBA VM SPUL DPAO VAOLY KVJBTLUAZ, IBA HZ P ZABKPLK AOLT P ILNHU AV YLHSPZL AOHA H UBTILY VM AOLT OPUALK HA LCLUAZ AOHA P JVBSKU’A MPUK PU AOL OPZAVYPJHS YLJVYK. JLYAHPU UHTLZ HWWLHYLK HUK DLYL JSLHYSF PTWVYAHUA, HUK AOLU KPZHWWLHYLK JVTWSLALSF MYVT AYHJL. KPWSVTHAPJ PUJPKLUAZ DLYL TLUAPVULK AOHA ULCLY OHWWLULK HJJVYKPUN AV AOL OPZAVYF IVVRZ. VUL AOPUN FVB SLHYU PU AOPZ IBZPULZZ PZ AOHA AOL JPCPS ZLYCPJL ULCLY SLAZ HUF KLJPZPVU, OVDLCLY ZLJYLA, NV BUYLJVYKLK. VM JVBYZL AOHA TPNOA QBZA OHCL TLHUA AOVZL SLAALYZ HUK KVJBTLUAZ DLYL MHRL, IBA P WYPKL TFZLSM VU ILPUN HU LEJLSSLUA MVYNLY, HUK P DVBSK UVA OHCL ILLU HISL AV WYVKBJL AOLT. AOL WHWLY DHZ YPNOA, AOL PUR DHZ JOLTPJHSSF JVYYLJA HUK HNLK QBZA AOL YPNOA HTVBUA, HUK AOL ZAFSL VM DYPAPUN DHZ AVAHSSF JVUCPUJPUN. HUK P DHZ JVUCPUJLK. JVUCPUJLK AOHA ZVTLDOLYL AOLYL TBZA IL HU HYJOPCL VM NVCLYUTLUA KVJBTLUAZ MYVT AOL WLYPVK AOHA YLJVYKLK HSS VM AOLZL TPZZPUN ZAVYPLZ PU MBSS. "
    text = "life had been relatively dull since returning from my work with harry in the middle east"
    #text = "XSFJD JMNRF RUDJV LMYFT GWWHP TUDIA HWRMS XXAHJ DNBRH  QTOFF NWFGH GLDJJ ATQWH UEQEM DMHRH LMCGL ZAYBT HUWIC  MHDJI CGFVZ TJHWR FYBXB HTTLX AHFLY MHDKM ZKTPS SUMRH  FHLRU WATHU JVLTQ LZSGS NAFWL WUGXD UYCHS WZJWH SIAIY  GYLSQ CMDDF IMXHX JNNRY REFEX NWHTM LNEDJ CYDRM HIGXL  VJLXQ HUYLH SLUYL TSVSH NBTQK FHWTQ DNHXU DQRYG YVSQF  MMRKJ QHZOV SIMGH HTMLN EDJQB YKGZN XSFJD JMNRF XUBIG  JRUKP PSSOE NVSXY GNRJQ YVYXJ JLBSF JDJMT JJFJA DDLYB  XZQAA YKXLL DIYXX JWYRF WAYML NPHQY LYHFH LRUWA THBXD  DQUUT XLYLT SVXTL FNQYN HMJOD NABGO WSOFG HJXIK YHPYM  HZQVX UGILE FAXXL FYITX WJJUF TIFTH LJQKJ NAJUW FLXRD  FDGTS BOFSL YRHJL YTUEY BTYWJ FHLKR JRUMN RFXIF JVLWU  BLKLK IKBDJ IUGIV GRYOJ UQHIF UOWCG HXWAS PHQYW XQTUS  ASAEJ WLJLL KRJSO FGHJX UGIXK JGTYK KYIWT WZJNK FQKKI  KRDLN IGMRO JPXWQ GRUMY HJBBB HKEJN ATGAX OLJGL MYKJV  MQNBS JKHLT REDJX WFWSX NKJDE XBHZO VLCOJ QGMCG YVSGI  NYKGB CMBDK JHVWB HYYWI XJNHZ BRJQX PFUAN NAJDD QCXXV  UTLXI VGRYG TWSGF XALUY IKNHK FATNQ KYNAJ JWWGT SVTJW  TZVWY BXNUW SWKDS LNIGX BKYYF XGAIH HYVMK ZBHLW SNEDV  UWUFG OWRYL XDYJM KNJGW INXPS YBXRD LNWTQ DFFFR XLKGS  TQOAJ XVTGW HLTHN WWMEF LVGUK JSSYN XWQKM CWIHF BCMML  FYBXR HKXUZ JVSSX NXHVY BXRWG WYVWH SYYMM HEFWA NQWZM  XIWGJ HVWBH YNAJP LMILJ FGIYL WHNTF OJGSW INSGL MYNXH  GKMXH UWYEX DVLMU MBHJJ MAFUW IUFTQ YYBHX HOMIG JHVJX  MTFGR GNSLU FNXXH UZLXQ BLMYL JDJJE GTZFF MLDPE JNKNF  WSWKD SLNIG XBKYY FXDFI BTAHS BYTPQ WXMBS WZFNX AHJDI  GJLFA IEAHV MULYR HTMLJ VKYBX XDEJM XYRXX YVWHL PYRX "
    print(get_english_score(text))
